# name: Docker Build and Push

# on:
#   push:
#     tags:
#     - 'v*.*.*'

# env:
#   REGISTRY: ghcr.io
#   IMAGE_NAME: ${{ github.repository }}

# jobs:
#   build-and-push:
#     runs-on: ubuntu-latest
#     permissions:
#       contents: read
#       packages: write

#     steps:
#     - name: Checkout repository
#       uses: actions/checkout@v4
#       with:
#         fetch-depth: 0

#     - name: Get version from tag
#       id: get_version
#       run: |
#         VERSION=${GITHUB_REF#refs/tags/}
#         echo "version=${VERSION}" >> $GITHUB_OUTPUT
#         echo "Using version: ${VERSION}"

#     - name: Log in to the Container registry
#       uses: docker/login-action@v3
#       with:
#         registry: ${{ env.REGISTRY }}
#         username: ${{ github.actor }}
#         password: ${{ secrets.GITHUB_TOKEN }}

#     - name: Extract metadata (tags, labels) for Docker
#       id: meta
#       uses: docker/metadata-action@v5
#       with:
#         images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}

#     - name: Build and push Docker image
#       uses: docker/build-push-action@v5
#       with:
#         context: .
#         push: true
#         tags: |
#           ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ steps.get_version.outputs.version }}
#           ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:latest
#         labels: |
#           org.opencontainers.image.version=${{ steps.get_version.outputs.version }}
#           org.opencontainers.image.source=${{ github.server_url }}/${{ github.repository }}
#           org.opencontainers.image.created=${{ steps.meta.outputs.created }}
#           org.opencontainers.image.revision=${{ github.sha }}
